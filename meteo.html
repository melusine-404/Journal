<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>MÃ©tÃ©o</title>
  <style>
    body {
      font-family: sans-serif;
      background: #111;
      color: white;
      text-align: center;
      padding: 40px;
    }

    h1 {
      font-size: 3em;
      margin-bottom: 40px;
    }

    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 60px);
      gap: 12px;
      justify-content: center;
    }

    .day {
      width: 60px;
      height: 90px;
      background: white;
      border-radius: 10px;
      color: black;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 18px;
      gap: 4px;
    }

    .mood, .battery {
      user-select: none;
    }

    .day-number {
      font-size: 0.8em;
      color: #666;
    }
  </style>
</head>
<body>
  <h1>MÃ©tÃ©o</h1>
  <div class="calendar" id="calendar"></div>

  <script>
    const moods = ['ğŸ˜', 'ğŸ˜Š', 'ğŸ˜'];
    const batteries = ['ğŸª«', 'ğŸ”‹', 'âš¡'];
    const calendar = document.getElementById("calendar");
    const today = new Date();
    const year = today.getFullYear();
    const month = today.getMonth();
    const key = `mood-tracker-${year}-${String(month+1).padStart(2, '0')}`;
    const stored = JSON.parse(localStorage.getItem(key) || '{}');
    const daysInMonth = new Date(year, month + 1, 0).getDate();

    for (let i = 1; i <= daysInMonth; i++) {
      const cell = document.createElement("div");
      cell.className = "day";

      const moodDiv = document.createElement("div");
      moodDiv.className = "mood";
      moodDiv.innerText = stored[i]?.mood || moods[0];
      moodDiv.onclick = e => {
        e.stopPropagation();
        const current = moods.indexOf(moodDiv.innerText);
        moodDiv.innerText = moods[(current + 1) % moods.length];
        updateStore(i, moodDiv.innerText, batteryDiv.innerText);
      };

      const batteryDiv = document.createElement("div");
      batteryDiv.className = "battery";
      batteryDiv.innerText = stored[i]?.battery || batteries[0];
      batteryDiv.onclick = e => {
        e.stopPropagation();
        const current = batteries.indexOf(batteryDiv.innerText);
        batteryDiv.innerText = batteries[(current + 1) % batteries.length];
        updateStore(i, moodDiv.innerText, batteryDiv.innerText);
      };

      const dayNum = document.createElement("div");
      dayNum.className = "day-number";
      dayNum.innerText = i;

      cell.appendChild(moodDiv);
      cell.appendChild(batteryDiv);
      cell.appendChild(dayNum);

      calendar.appendChild(cell);
    }

    function updateStore(day, mood, battery) {
      stored[day] = { mood, battery };
      localStorage.setItem(key, JSON.stringify(stored));
    }
  </script>
</body>
</html>
